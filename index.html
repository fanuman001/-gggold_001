<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ELITE Pay - å‚µå‹™çµç®—</title>
    <style>
        :root { --blue: #00d2ff; --red: #ff4757; --green: #2ed573; --gold: #ffa502; --bg: #0d1117; --card: #1c222b; --border: #30363d; --gray: #8b949e; }
        body { font-family: -apple-system, sans-serif; background: var(--bg); color: #fff; margin: 0; padding: 12px; }
        .card { background: var(--card); padding: 18px; border-radius: 20px; margin-bottom: 12px; border: 1px solid var(--border); }
        
        /* è¼¸å…¥å€æ¨£å¼ */
        .input-group { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
        select, input { background: #000; border: 1px solid #444; color: #fff; padding: 12px; border-radius: 10px; font-size: 16px; }
        
        /* æœ‹å‹æ¸…å–® */
        .friend-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; margin: 10px 0; }
        .p-chip { padding: 10px; background: #21262d; border: 2px solid #30363d; border-radius: 12px; text-align: center; font-size: 14px; opacity: 0.5; }
        .p-chip.active { opacity: 1; border-color: var(--blue); color: var(--blue); }

        /* å‚µå‹™é¡¯ç¤º */
        .debt-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #333; }
        .debt-val { font-weight: bold; font-size: 18px; }
        .btn-settle { background: var(--green); color: #000; border: none; padding: 5px 12px; border-radius: 6px; font-size: 12px; font-weight: bold; }

        .btn-main { width: 100%; padding: 16px; background: var(--blue); color: #000; border: none; border-radius: 12px; font-weight: bold; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>

<div class="card">
    <h2 style="margin-top:0; color:var(--gold);">â• æ–°å¢æ”¯å‡º</h2>
    <div class="input-group">
        <label>èª°å¢ŠéŒ¢ï¼Ÿ</label>
        <select id="payer"></select>
        
        <label>ç¸½é‡‘é¡</label>
        <input type="number" id="amount" placeholder="ä¾‹å¦‚ï¼š1200">
        
        <label>èª°è¦åˆ†æ”¤ï¼Ÿ(å¤šé¸)</label>
        <div id="friend-selector" class="friend-grid"></div>
    </div>
    <button class="btn-main" onclick="addExpense()">ç¢ºèªæ–°å¢æ”¯å‡º</button>
</div>

<div class="card">
    <h2 style="margin-top:0; color:var(--blue);">ğŸ“Š å‚µå‹™é¤˜é¡</h2>
    <div id="debt-list"></div>
    <button onclick="clearAll()" style="width:100%; margin-top:20px; background:none; border:1px solid var(--red); color:var(--red); padding:10px; border-radius:10px;">âš ï¸ å…¨éƒ¨æ¸…é›¶çµæ¡ˆ</button>
</div>

<script>
    // åˆå§‹åå–®ï¼Œä¹‹å¾Œå¯å¾ä½ çš„è³‡æ–™åº«è®€å–
    let friends = ["é˜¿æ˜", "å°è¯", "å¤§å¼·", "è€ç‹", "æ°å“¥"];
    let balances = {}; // å­˜å„²æ¯å€‹äººçš„é¤˜é¡
    let selectedSharebers = new Set();

    function init() {
        const payerSelect = document.getElementById('payer');
        const selector = document.getElementById('friend-selector');
        
        friends.forEach(name => {
            balances[name] = 0;
            // å¡«å……ä¸‹æ‹‰é¸å–®
            payerSelect.innerHTML += `<option value="${name}">${name}</option>`;
            // å¡«å……å¤šé¸å€
            selector.innerHTML += `<div class="p-chip" id="chip-${name}" onclick="toggleShare('${name}')">${name}</div>`;
        });
        render();
    }

    function toggleShare(name) {
        if(selectedSharebers.has(name)) selectedSharebers.delete(name);
        else selectedSharebers.add(name);
        document.getElementById(`chip-${name}`).classList.toggle('active');
    }

    function addExpense() {
        const payer = document.getElementById('payer').value;
        const amt = parseFloat(document.getElementById('amount').value);
        
        if(!amt || selectedSharebers.size === 0) return alert("è«‹è¼¸å…¥é‡‘é¡ä¸¦é¸æ“‡åˆ†æ”¤äºº");

        const shareAmt = amt / selectedSharebers.size;

        // è¨ˆç®—é‚è¼¯ï¼šå¢ŠéŒ¢çš„äººé¤˜é¡å¢åŠ ï¼Œè¢«åˆ†æ”¤çš„äººé¤˜é¡æ¸›å°‘
        // é€™è£¡å¦‚æœæ˜¯ payer æœ¬äººä¹Ÿæœ‰åˆ†æ”¤ï¼Œé‚è¼¯ä¾ç„¶æ­£ç¢ºï¼ˆåŠ å›åˆæ‰£é™¤ï¼‰
        friends.forEach(name => {
            if (name === payer) {
                balances[name] += amt; // å¢ŠéŒ¢çš„äººæš«æ™‚æ‹¿å›å…¨é¡
            }
            if (selectedSharebers.has(name)) {
                balances[name] -= shareAmt; // åƒèˆ‡åˆ†æ”¤çš„äººæ‰£é™¤æ‡‰ä»˜ä»½é¡
            }
        });

        // é‡ç½®è¼¸å…¥
        document.getElementById('amount').value = '';
        render();
        alert(`æ–°å¢æˆåŠŸï¼${payer} å¢Šä»˜äº† ${amt}å…ƒ`);
    }

    function settleOne(name) {
        if(confirm(`ç¢ºèª ${name} çš„å¸³å‹™å·²çµæ¸…ï¼Ÿ`)) {
            balances[name] = 0;
            render();
        }
    }

    function clearAll() {
        if(confirm("ç¢ºå®šè¦å°‡æ‰€æœ‰å‚µå‹™æ¸…é›¶å—ï¼Ÿæ­¤å‹•ä½œä¸å¯é€†ã€‚")) {
            friends.forEach(name => balances[name] = 0);
            render();
        }
    }

    function render() {
        const list = document.getElementById('debt-list');
        list.innerHTML = "";
        
        friends.forEach(name => {
            const val = Math.round(balances[name]);
            let color = "var(--gray)";
            let prefix = "";
            
            if (val > 0) { color = "var(--green)"; prefix = "å¯æ”¶å› $"; }
            else if (val < 0) { color = "var(--red)"; prefix = "æ‡‰é‚„æ¬¾ $"; }
            else { prefix = "å·²çµæ¸… $"; }

            list.innerHTML += `
                <div class="debt-item">
                    <div>
                        <b>${name}</b><br>
                        <small style="color:${color}">${prefix}${Math.abs(val)}</small>
                    </div>
                    ${val !== 0 ? `<button class="btn-settle" onclick="settleOne('${name}')">å·²çµ</button>` : ''}
                </div>
            `;
        });
    }

    init();
</script>
</body>
</html>

